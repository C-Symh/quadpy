import warnings

import numpy

from ..helpers import article, untangle, z, fsd
from ._helpers import DiskScheme

_citation = article(
    authors=["KyoungJoong Kim", "ManSuk Song"],
    title="Symmetric quadrature formulas over a unit disk",
    journal="Korean J. Comp. & Appl. Math.",
    year="1997",
    volume="4",
    pages="179-192",
    url="https://doi.org/10.1007/BF03011388",
)


def kim_song_1():
    data = [
        (3.141592653589793, z(2)),
    ]
    points, weights = untangle(data)
    points = points.astype(numpy.float)
    return DiskScheme("Kim-Song 1", weights, points, 1, _citation)


def kim_song_2():
    data = [
        (0.785398163397448, fsd(2, (0.707106781186548, 1))),
    ]
    points, weights = untangle(data)
    return DiskScheme("Kim-Song 2", weights, points, 3, _citation)


def kim_song_3():
    data = [
        (0.785398163397448, fsd(2, (0.5, 2))),
    ]
    points, weights = untangle(data)
    return DiskScheme("Kim-Song 3", weights, points, 3, _citation)


def kim_song_4():
    data = [
        (0.732786462492640, fsd(2, (0.650115167343736, 1))),
        (0.052611700904808, fsd(2, (0.888073833977115, 2))),
    ]
    points, weights = untangle(data)
    return DiskScheme("Kim-Song 4", weights, points, 5, _citation)


def kim_song_5():
    data = [
        (0.785398163397449, z(2)),
        (0.294524311274043, fsd(2, (0.754344479484572, 1), (0.312459714103782, 1))),
    ]
    points, weights = untangle(data)
    return DiskScheme("Kim-Song 5", weights, points, 5, _citation)


def kim_song_6():
    data = [
        (0.232710566932577, fsd(2, (0.866025403784439, 1))),
        (0.387077796006226, fsd(2, (0.322914992067400, 2))),
        (0.165609800458645, fsd(2, (0.644171310389465, 2))),
    ]
    points, weights = untangle(data)
    return DiskScheme("Kim-Song 6", weights, points, 7, _citation)


def kim_song_7():
    data = [
        (0.071488826617391, fsd(2, (0.952458896434417, 1))),
        (0.327176874928167, fsd(2, (0.415187657878755, 1))),
        (0.005591341512851, fsd(2, (0.834794942216211, 2))),
        (0.190570560169519, fsd(2, (0.740334457173511, 1), (0.379016937530835, 1))),
    ]
    points, weights = untangle(data)
    return DiskScheme("Kim-Song 7", weights, points, 9, _citation)


def kim_song_8():
    data = [
        (-0.103220620849181, z(2)),
        (0.000561120485457, fsd(2, (1.081713912649978, 2))),
        (0.234185472691706, fsd(2, (0.329855087221954, 2))),
        (0.123731369524117, fsd(2, (0.163309595229403, 2))),
        (0.194337435615691, fsd(2, (0.582963679648472, 2))),
        (0.129193960146342, fsd(2, (0.862551409331466, 1), (0.191706749096887, 1))),
    ]
    points, weights = untangle(data)
    # ERR article claims degree 11
    warnings.warn("Kim-Song claim degree 11, but the scheme is only degree 1.")
    return DiskScheme("Kim-Song 8", weights, points, 1, _citation)


def kim_song_9():
    data = [
        (.051310052712355, fsd(2, (.680167267076408, 2))),
        (.208368275231940, fsd(2, (.232463234651158, 2))),
        (.113628206510048, fsd(2, (.547722557505169, 2))),
        (.126977836503225, fsd(2, (.652159581445885, 1), (.174745633184644, 1))),
        (.079067977968328, fsd(2, (.904823085572323, 1), (.242446615072141, 1))),
    ]
    points, weights = untangle(data)
    return DiskScheme("Kim-Song 9", weights, points, 11, _citation)


def kim_song_10():
    data = [
        (.156239869837333, fsd(2, (.283402832348825, 1))),
        (.069447409266977, fsd(2, (.920575474036251, 1))),
        (.138145910534871, fsd(2, (.649007230578002, 1))),
        (.043376583887155, fsd(2, (.677355106028069, 2))),
        (.150228334140010, fsd(2, (.412672216763289, 2))),
        (.018199321926118, fsd(2, (.938694583835123, 1), (.335767600829539, 1))),
        (.095780705939433, fsd(2, (.752042776803954, 1), (.379717011170077, 1))),
    ]
    points, weights = untangle(data)
    return DiskScheme("Kim-Song 10", weights, points, 13, _citation)


def kim_song_11():
    data = [
        (.125290208564338, fsd(2, (.252863797091293, 1))),
        (.016712625496982, fsd(2, (.989746802511614, 1))),
        (.109500391126365, fsd(2, (.577728928444958, 1))),
        (.066237455796397, fsd(2, (.873836956645035, 1))),
        (.026102860184358, fsd(2, (.689299380791136, 2))),
        (.066000934661100, fsd(2, (.597614304667208, 2))),
        (.127428372681720, fsd(2, (.375416824626170, 2))),
        (.042523065826681, fsd(2, (.883097111318591, 1), (.365790800400663, 1))),
        (.081539591616413, fsd(2, (.707438744960070, 1), (.293030722710664, 1))),
    ]
    points, weights = untangle(data)
    return DiskScheme("Kim-Song 11", weights, points, 15, _citation)


def kim_song_12():
    data = [
        (.034218732123473, fsd(2, (.000061843487605, 1))),
        (.016529016194279, fsd(2, (.980790725733799, 1))),
        (.128441621643862, fsd(2, (.536380801743208, 1))),
        (.057523498415081, fsd(2, (.859692027602019, 1))),
        (.000019445945395, fsd(2, (.890507932479849, 2))),
        (.029882788585530, fsd(2, (.597728327225623, 2))),
        (.086625257876566, fsd(2, (.472638508474430, 2))),
        (.135289763196368, fsd(2, (.256583368615187, 2))),
        (.030442743336826, fsd(2, (.915666628257231, 1), (.290750921163427, 1))),
        (.036355668706617, fsd(2, (.775130682141990, 1), (.550400039905684, 1))),
        (.081635607665003, fsd(2, (.722293685844502, 1), (.274942296086914, 1))),
    ]
    points, weights = untangle(data)
    # ERR article claims degree 17
    warnings.warn("Kim-Song claim degree 17, but the scheme is only degree 3.")
    return DiskScheme("Kim-Song 12", weights, points, 3, _citation)


def kim_song_13():
    data = [
        (.107540143418461, fsd(2, (.233779702361770, 1))),
        (.021291625083247, fsd(2, (.974967664200431, 1))),
        (.082028519637405, fsd(2, (.670603246539245, 1))),
        (.000480959036869, fsd(2, (.767149887105600, 2))),
        (.055918006547614, fsd(2, (.529910286773986, 2))),
        (.020154425991986, fsd(2, (.920197160917920, 1), (.324880277222329, 1))),
        (.056453982349758, fsd(2, (.696315960030871, 1), (.353373943382497, 1))),
        (.038487694687371, fsd(2, (.763756057536127, 1), (.554819904211117, 1))),
        (.096415834450115, fsd(2, (.455714401760160, 1), (.222878364006045, 1))),
        (.047557517357696, fsd(2, (.855907714936672, 1), (.165103693017075, 1))),
    ]
    points, weights = untangle(data)
    return DiskScheme("Kim-Song 13", weights, points, 17, _citation)


def kim_song_14():
    data = [
        (-.336959088794964, fsd(2, (.860125674956782, 1))),
        (-.252102704609804, fsd(2, (.860125119919931, 1))),
        (+.131164048626801, fsd(2, (.547071550894734, 1))),
        (-.010919895825604, fsd(2, (.927565701076356, 2))),
        (+.010744805554708, fsd(2, (.928162274936277, 2))),
        (+.004798012482265, fsd(2, (.755935467576794, 2))),
        (+.072711702889623, fsd(2, (.618205357502056, 2))),
        (+.115883691032049, fsd(2, (.398705530364909, 2))),
        (+.123519504105529, fsd(2, (.175541035301314, 2))),
        (+.022426281825809, fsd(2, (.959568314399471, 1), (.155454100986327, 1))),
        (+.033906878046312, fsd(2, (.851375493057155, 1), (.435023471372536, 1))),
        (+.332072154179621, fsd(2, (.858667011279674, 1), (.030948726948493, 1))),
        (+.074873729916680, fsd(2, (.711569636216547, 1), (.300178547400372, 1))),
    ]
    points, weights = untangle(data)
    # ERR article claims degree 19
    warnings.warn("Kim-Song claim degree 19, but the scheme is only degree 3.")
    return DiskScheme("Kim-Song 14", weights, points, 3, _citation)


def kim_song_15():
    data = [
        (.082558858859169, fsd(2, (.204668989256100, 1))),
        (.009721593541193, fsd(2, (.992309839464756, 1))),
        (.061920685878045, fsd(2, (.740931035494388, 1))),
        (.079123279187043, fsd(2, (.477987648986077, 1))),
        (.087526733002317, fsd(2, (.306138805262459, 2))),
        (.057076811471306, fsd(2, (.524780156099700, 2))),
        (.020981864256888, fsd(2, (.921806074110042, 1), (.310920075968188, 1))),
        (.015226392255721, fsd(2, (.790235832571934, 1), (.579897645710646, 1))),
        (.033136884897617, fsd(2, (.725790566968788, 1), (.525045580895713, 1))),
        (.044853730819348, fsd(2, (.788230650371813, 1), (.290244481132460, 1))),
        (.065321481701811, fsd(2, (.584894890453686, 1), (.264317463415838, 1))),
        (.024214746797802, fsd(2, (.909637445684200, 1), (.092571132370888, 1))),
    ]
    points, weights = untangle(data)
    # ERR article claims degree 19
    warnings.warn("Kim-Song claim degree 19, but the scheme is only degree 9.")
    return DiskScheme("Kim-Song 15", weights, points, 9, _citation)
