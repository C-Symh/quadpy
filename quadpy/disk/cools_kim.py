# -*- coding: utf-8 -*-
#
import numpy


class CoolsKim(object):
    '''
    R. Cools, K.J. Kim
    A survey of known and cubature formulas for the unit disk,
    Korean J. Comput. & Appl. Math. Vol. 7(2000), No. 3, pp. 477 - 485,
    DOI: 10.1007/BF03012263.
    '''
    def __init__(self, index):
        self.name = 'CK(%d)' % index
        if index == 1:
            self.degree = 17
            self.weights = numpy.concatenate([
                numpy.full(1, 0.11498334179998566),
                #
                numpy.full(4, 0.042666281539386779),
                numpy.full(4, 0.087938325357145539),
                numpy.full(4, 0.076206570461793249),
                #
                numpy.full(4, 0.019156522218855521),
                numpy.full(4, 0.062085722273139239),
                numpy.full(4, 0.095664962820418119),
                #
                numpy.full(8, 0.085162533604288747),
                numpy.full(8, 0.020201237989565462),
                numpy.full(8, 0.056834571713156972),
                numpy.full(8, 0.024268628331345539),
                ])
            self.points = numpy.concatenate([
                numpy.array([[0.0, 0.0]]),
                _s40(0.88696766316393713),
                _s40(0.42463390374323367),
                _s40(0.69446902308083445),
                _s4(0.68785354082699271),
                _s4(0.59664767781455707),
                _s4(0.23562252091530831),
                _s8(0.31294754888343992, 0.54894025523701459),
                _s8(0.96121228504617867, 0.17385745088683603),
                _s8(0.30538732225214729, 0.79035487531148609),
                _s8(0.84937290409632805, 0.46270056598293749),
                ])
        elif index == 2:
            self.degree = 19
            self.weights = numpy.concatenate([
                numpy.full(1, 0.092826182741729107),
                #
                numpy.full(4, 0.061210649714171629),
                numpy.full(4, 0.084701305074092631),
                numpy.full(4, 0.0064918529741922661),
                #
                numpy.full(4, 0.014104347317113714),
                numpy.full(4, 0.077590938349196292),
                numpy.full(4, 0.046841922848831439),
                numpy.full(4, 0.071523458803010660),
                #
                numpy.full(8, 0.077267777905420501),
                numpy.full(8, 0.034350583657896668),
                numpy.full(8, 0.028368949384516057),
                numpy.full(8, 0.0018669074320751099),
                numpy.full(8, 0.058009352935795362),
                ])
            self.points = numpy.concatenate([
                numpy.array([[0.0, 0.0]]),
                _s40(0.79836610957931832),
                _s40(0.30042292336770777),
                _s40(0.99615333438631671),
                _s4(0.69583191637449732),
                _s4(0.28670391168237706),
                _s4(0.61667878163587778),
                _s4(0.47214212637530880),
                _s8(0.56686082157858617, 0.15587783378762243),
                _s8(0.92555127310854838, 0.17347695471172525),
                _s8(0.83822144355055265, 0.46025996563724600),
                _s8(0.96670876580048578, 0.33737925901740466),
                _s8(0.73773390012389973, 0.32685240870845720),
                ])
        else:
            assert index == 3
            self.degree = 21
            self.weights = numpy.concatenate([
                numpy.full(4, 0.064712088156233115),
                numpy.full(4, 0.012203257346077736),
                #
                numpy.full(4, 4.6214466764876138e-05),
                numpy.full(4, 0.020941123674084990),
                numpy.full(4, 0.044321766954122515),
                numpy.full(4, 0.052715691149269700),
                #
                numpy.full(8, 0.028690025849304919),
                numpy.full(8, 0.013819709344648730),
                numpy.full(8, 0.037034888202855274),
                numpy.full(8, 0.047520136607474831),
                numpy.full(8, 0.014296165120136605),
                numpy.full(8, 0.042923763669888949),
                numpy.full(8, 0.047444099811669938),
                numpy.full(8, 0.063500222219468438),
                ])
            self.points = numpy.concatenate([
                _s40(0.18089963670914432),
                _s40(0.98391537714755427),
                _s4(0.77364389614737803),
                _s4(0.67975937134823609),
                _s4(0.59230560995561076),
                _s4(0.41774444740353380),
                _s8(0.89789289495208579, 0.13375169526590821),
                _s8(0.93927352486965313, 0.27985732696474981),
                _s8(0.79099671385625722, 0.39385576573951899),
                _s8(0.56605481445792489, 0.10885005806786229),
                _s8(0.83180776464845906, 0.51224072541565606),
                _s8(0.76010583069266321, 0.12830595415488073),
                _s8(0.62209339812108792, 0.34691040719842391),
                _s8(0.36200059276768541, 0.16676191877222966),
                ])
        return


def _s4(a):
    return numpy.array([
        [+a, +a],
        [-a, +a],
        [+a, -a],
        [-a, -a],
        ])


def _s40(a):
    return numpy.array([
        [+a, 0.0],
        [-a, 0.0],
        [0.0, +a],
        [0.0, -a],
        ])


def _s8(a, b):
    return numpy.array([
        [+a, +b],
        [-a, +b],
        [+a, -b],
        [-a, -b],
        [+b, +a],
        [-b, +a],
        [+b, -a],
        [-b, -a],
        ])
