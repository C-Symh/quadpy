# -*- coding: utf-8 -*-
#
from .helpers import _s3, _s21, _s111

from ..helpers import untangle


class Papanicolopulos(object):
    '''
    Stefanos-Aldo Papanicolopulos,
    New fully symmetric and rotationally symmetric cubature rules on the
    triangle using minimal orthonormal bases,
    Journal of Computational and Applied Mathematics,
    Volume 294, 1 March 2016, Pages 39â€“48,
    <https://doi.org/10.1016/j.cam.2015.08.001>,
    <https://arxiv.org/abs/1411.5631>.
    '''
    def __init__(self, index):
        self.name = 'Papanicolopulos'
        if index == 0:
            self.degree = 15
            data = [
                (-8.7456325826448314e-02, _s21(2.9593233914348055e-01)),
                (1.1825359733915675e-02, _s21(1.1041137294398808e-01)),
                (1.3633359800590992e-02, _s21(5.5556777591097777e-02)),
                (1.8152749803642489e-02, _s21(4.9053686136135088e-01)),
                (6.0151078120269021e-02, _s21(2.3261140392265686e-01)),
                (1.2218012059443138e-01, _s21(3.7093650636643044e-01)),
                (2.5613719808681695e-03, _s111(1.7707930875254373e-03, 3.8231237353261144e-02)),
                (1.2198751372066793e-02, _s111(1.7499897301341594e-02, 1.4981904161827897e-01)),
                (1.6436943369443905e-02, _s111(1.8423065211738483e-02, 3.0745294013740204e-01)),
                (2.8386552060758415e-02, _s111(9.1205272592313119e-02, 2.0385875286816799e-01)),
                (3.7839876770328761e-02, _s111(9.7542934824370500e-02, 3.6325540013204588e-01)),
                ]
        elif index == 1:
            self.degree = 17
            data = [
                (4.2349520256914651e-02, _s3()),
                (2.9196690345779362e-03, _s21(1.4939063814610984e-02)),
                (9.3338193514883386e-03, _s21(4.9509703292414220e-01)),
                (1.5579210009132786e-02, _s21(8.0176519909013158e-02)),
                (2.5862383995094124e-02, _s21(4.6672613808660018e-01)),
                (2.7157513575493317e-02, _s21(1.5914935745128311e-01)),
                (3.8226206597189359e-02, _s21(4.0958102196506480e-01)),
                (3.8609391683443878e-02, _s21(2.4459731986078312e-01)),
                (5.2599615183941239e-04, _s111(-1.7099279594795083e-02, 3.0469846218081181e-01)),
                (6.8369805127641023e-03, _s111(1.5606149478884756e-02, 7.7467710451680744e-02)),
                (7.7402981968328509e-03, _s111(1.2499472547638271e-02, 1.8300737741132522e-01)),
                (1.7306871686136278e-02, _s111(2.4893796930192783e-02, 3.3136103343509682e-01)),
                (1.7633848414214556e-02, _s111(6.0954488983763454e-02, 1.9083979150163133e-01)),
                (3.0720321205517157e-02, _s111(1.1094663204631958e-01, 3.0371331245075517e-01)),
                ]
        elif index == 2:
            self.degree = 21
            data = [
                (1.5325221415702992e-03, _s21(1.0830647913896135e-02)),
                (2.9596420858008904e-03, _s21(4.9868116928006762e-01)),
                (7.1050719519832268e-03, _s21(5.3206302593702216e-02)),
                (1.2422025450151194e-02, _s21(4.8436880679907196e-01)),
                (1.3153853090548603e-02, _s21(1.1717932446409532e-01)),
                (1.6107119933559410e-02, _s21(1.8619987453160045e-01)),
                (1.9556998327421530e-02, _s21(2.3770504697050238e-01)),
                (2.1147145803411153e-02, _s21(4.5111809686333143e-01)),
                (2.1487249618095533e-02, _s21(2.9890161661837961e-01)),
                (3.2432160362971586e-03, _s111(1.0170375513970238e-02, 5.6106078740441129e-02)),
                (4.4460668245672958e-03, _s111(7.4014800191294266e-03, 2.3806090893927820e-01)),
                (4.4471370127689858e-03, _s111(9.4888802100390364e-03, 1.3371423612729252e-01)),
                (7.1928300897944027e-03, _s111(1.0787085289532927e-02, 3.6087827036133641e-01)),
                (9.6881827696773583e-03, _s111(4.8886410156411965e-02, 1.2856000707434670e-01)),
                (1.0771867254746005e-02, _s111(4.0790478434921389e-02, 2.3192922019831619e-01)),
                (1.5376448792274195e-02, _s111(1.0225476525427213e-01, 2.1318238024685213e-01)),
                (1.5418201625050997e-02, _s111(5.6195103726493438e-02, 3.4615363893081413e-01)),
                (1.8727994081823490e-02, _s111(1.9392111402204942e-01, 3.5741779412597602e-01)),
                (1.9618907978395862e-02, _s111(1.3139693759954926e-01, 3.0964180048539108e-01)),
                ]
        elif index == 3:
            self.degree = 22
            data = [
                (1.8046065005519342e-02, _s3()),
                (1.4440555795319798e-03, _s21(1.0496492318532830e-02)),
                (6.2664664495599813e-03, _s21(4.9553364518875165e-01)),
                (7.6517443601230228e-03, _s21(5.6049615132866118e-02)),
                (1.3279847784100933e-02, _s21(4.7666520586421668e-01)),
                (1.5110120003822509e-02, _s21(1.3171604835404205e-01)),
                (1.7591885388871395e-02, _s21(4.4330230475416338e-01)),
                (1.8843708393925265e-02, _s21(3.9478401564445792e-01)),
                (1.9848233599481159e-02, _s21(2.1160132731775527e-01)),
                (2.0867162478628788e-02, _s21(2.8055888993860051e-01)),
                (2.4014487111013746e-12, _s111(-3.6575820128899073e-01, 1.2177577928997972e-01)),
                (3.3916987259453458e-03, _s111(1.0866084504841705e-02, 5.4699006820643735e-02)),
                (4.7426763618685095e-03, _s111(6.9864102072462820e-03, 3.6084608822824210e-01)),
                (5.1719891070370321e-03, _s111(1.1088449518326875e-02, 1.3147683381028283e-01)),
                (5.6281199112128266e-03, _s111(9.4991301059710580e-03, 2.3579984150473896e-01)),
                (1.0573950573404284e-02, _s111(3.7046616048002780e-02, 3.5355846422612314e-01)),
                (1.1086612482236757e-02, _s111(5.6598109252542855e-02, 1.3252717627467012e-01)),
                (1.2134510421606178e-02, _s111(4.9307086657456631e-02, 2.3345541183681795e-01)),
                (1.5154378475876465e-02, _s111(9.1696755829684576e-02, 3.4021642111357170e-01)),
                (1.6798674545460295e-02, _s111(1.1809385707142292e-01, 2.2811097966249483e-01)),
                (1.8524766539675115e-02, _s111(1.7225220098241623e-01, 3.1953217634733161e-01)),
                ]
        elif index == 4:
            self.degree = 22
            data = [
                (6.9714569625074026e-04, _s21(7.2282355159080528e-03)),
                (1.7336537619803626e-03, _s21(4.9971491656223188e-01)),
                (4.6613130430455734e-03, _s21(4.1952527272804088e-02)),
                (1.1584576765599566e-02, _s21(3.1413219152050093e-01)),
                (1.1878974033021910e-02, _s21(4.8001365161711657e-01)),
                (1.5338803655666700e-02, _s21(1.2308745423016115e-01)),
                (1.9716376940272336e-02, _s21(4.4571963043911533e-01)),
                (2.0572151491734754e-02, _s21(1.8986241218389369e-01)),
                (2.3840660278137037e-02, _s21(2.6033923338175580e-01)),
                (2.4461197089874872e-02, _s21(3.9636684767162600e-01)),
                (1.8286280273112092e-03, _s111(7.7395846886030781e-03, 3.9100167827328378e-02)),
                (1.8804497039628383e-03, _s111(5.7706413021840362e-04, 2.9956301031600607e-01)),
                (3.7041086400111016e-03, _s111(9.7957718535231410e-03, 9.9167580852252468e-02)),
                (4.6683403718348060e-03, _s111(9.1886802064989649e-03, 1.8619068155280571e-01)),
                (7.2113411719295856e-03, _s111(1.3467087568401818e-02, 4.0293889185510046e-01)),
                (7.9674333598873433e-03, _s111(5.0626312467336898e-02, 1.0358808540929187e-01)),
                (9.0358003694371355e-03, _s111(4.8388117761837650e-02, 1.8082300688832889e-01)),
                (9.4806411115590152e-03, _s111(2.7491435853260346e-02, 2.8194341507949189e-01)),
                (1.5617370128353208e-02, _s111(6.7133974447704386e-02, 3.5071285339799135e-01)),
                (1.6245319181056983e-02, _s111(9.6704303616860346e-02, 2.3017640440360132e-01)),
                (2.1784808223531512e-02, _s111(1.5193045482670228e-01, 3.1159323586348647e-01)),
                ]
        elif index == 5:
            self.degree = 23
            data = [
                (1.0233849339306483e-03, _s21(8.8430909856400085e-03)),
                (2.3495328561160744e-03, _s21(4.9904231799536475e-01)),
                (4.4227229483174649e-03, _s21(4.1918494631921203e-02)),
                (9.3593949345890711e-03, _s21(8.3843959400741894e-02)),
                (1.1223304907955516e-02, _s21(3.5156602225687805e-01)),
                (1.1455393860718664e-02, _s21(4.8142250008209758e-01)),
                (1.4851528190270431e-02, _s21(1.3603683917665685e-01)),
                (1.8733990977523034e-02, _s21(4.4588621023292907e-01)),
                (2.0095448898175008e-02, _s21(1.9833791969077397e-01)),
                (2.1869521602463023e-02, _s21(3.9764873352592073e-01)),
                (1.3903741389058627e-03, _s111(2.1537508898247914e-03, 1.1147822164436515e-01)),
                (2.0936131717002298e-03, _s111(7.9756704834337989e-03, 4.5998761911927387e-02)),
                (2.2627278911605850e-03, _s111(2.2252130687022897e-03, 2.9991704500621363e-01)),
                (5.0988760785318239e-03, _s111(1.0567990234213330e-02, 1.9450617255148173e-01)),
                (5.8027924863416356e-03, _s111(2.6390157960052386e-02, 1.0487601375183196e-01)),
                (6.9904741201632318e-03, _s111(1.3726614788916335e-02, 3.9359274155812224e-01)),
                (1.0105447412685495e-02, _s111(3.2931670717119124e-02, 2.7745010154284910e-01)),
                (1.0940686820111041e-02, _s111(5.6458369286788004e-02, 1.7041930960722382e-01)),
                (1.2697747467200144e-02, _s111(2.4905869950604637e-01, 2.8048464594062622e-01)),
                (1.4936905214735932e-02, _s111(6.7100228845598728e-02, 3.5940684385217631e-01)),
                (1.6245944888963148e-02, _s111(1.0095848404745636e-01, 2.3967897332407878e-01)),
                (2.0408964921138070e-02, _s111(1.5208140311691476e-01, 3.1660538238914820e-01)),
                ]
        elif index == 6:
            self.degree = 24
            data = [
                (2.2937943480967490e-02, _s3()),
                (7.6737746111581423e-04, _s21(7.6448158720914035e-03)),
                (5.5235784447516976e-03, _s21(4.9512326693489417e-01)),
                (8.3849953027563106e-03, _s21(8.5335714707740554e-02)),
                (1.2217380178002352e-02, _s21(4.7540435757943000e-01)),
                (1.3070390605611782e-02, _s21(1.4361312600254966e-01)),
                (1.7881227758429579e-02, _s21(4.4000137550057372e-01)),
                (1.8221744139097312e-02, _s21(2.0438684787130393e-01)),
                (2.1641497217567616e-02, _s21(3.9155520703268198e-01)),
                (2.1688312926922602e-02, _s21(2.6936069184956823e-01)),
                (1.7461845826617216e-03, _s111(1.2891576532218214e-03, 3.8930032117370400e-01)),
                (1.8385716037427871e-03, _s111(8.0461554413475099e-03, 3.9945518998510898e-02)),
                (1.9989366333621290e-03, _s111(3.9746390407908042e-03, 1.7756755351844719e-01)),
                (2.0636961713359080e-03, _s111(5.6533968387799801e-03, 9.7304373163390800e-02)),
                (2.2953950871584159e-03, _s111(3.6541646347000717e-02, 4.7379136469555827e-02)),
                (4.5795232889082318e-03, _s111(8.4720312527892441e-03, 2.7654233490622632e-01)),
                (5.2932300990954041e-03, _s111(3.1868785558484866e-02, 1.0186004800841345e-01)),
                (5.5787469959908817e-03, _s111(2.5074485756959322e-02, 1.7990041142989785e-01)),
                (8.6193394872566415e-03, _s111(2.4954649207236983e-02, 3.7476148829145151e-01)),
                (9.9923539922470699e-03, _s111(7.1806927489926675e-02, 1.6285371365641890e-01)),
                (1.0305616207681308e-02, _s111(4.6495368325225606e-02, 2.6299994692532691e-01)),
                (1.4604546126250248e-02, _s111(7.9445658328927776e-02, 3.5387462268603243e-01)),
                (1.4998500676250463e-02, _s111(1.1210496839891453e-01, 2.4045272001109688e-01)),
                (1.9230783117436680e-02, _s111(1.6288704432089313e-01, 3.1632883636136616e-01)),
                ]
        elif index == 7:
            self.degree = 25
            data = [
                (1.9730145564170694e-02, _s3()),
                (7.9784978009049068e-04, _s21(7.8022199979002112e-03)),
                (1.6540557559100446e-03, _s21(4.9920005126586386e-01)),
                (3.9483067815592552e-03, _s21(3.9745976060168636e-02)),
                (7.3059304419564701e-03, _s21(4.8948425246569233e-01)),
                (8.1278558796413266e-03, _s21(9.0694417901958868e-02)),
                (1.1970371685575694e-02, _s21(1.5122428135781504e-01)),
                (1.2299765626203808e-02, _s21(4.6721306520841810e-01)),
                (1.6112719176052503e-02, _s21(2.1191329495049538e-01)),
                (1.6232869701501101e-02, _s21(4.3276248978793980e-01)),
                (1.8798881038162154e-02, _s21(2.7376044759386797e-01)),
                (1.8817300377344574e-02, _s21(3.8736585153047043e-01)),
                (1.0058419636349749e-03, _s111(-1.7548642901802665e-04, 2.7505910881984064e-01)),
                (1.7768341951951061e-03, _s111(7.6272354243569927e-03, 4.0675651667317986e-02)),
                (2.5263768046607073e-03, _s111(7.1744598182213312e-03, 9.8073197818081104e-02)),
                (2.8903213344256395e-03, _s111(6.3674541720953543e-03, 1.7710896672593235e-01)),
                (4.3188177509815720e-03, _s111(7.4875157532566013e-03, 3.8161168515912564e-01)),
                (5.6280372428999812e-03, _s111(3.7463934879853701e-02, 9.5814659140257524e-02)),
                (6.2380351084315912e-03, _s111(1.8103532201923581e-02, 2.7060854554092645e-01)),
                (6.5242706554108380e-03, _s111(3.3495910148005362e-02, 1.7314445335143583e-01)),
                (9.5756742981397934e-03, _s111(3.9206711918798057e-02, 3.6987571368345934e-01)),
                (9.6717253781026906e-03, _s111(8.2016261697038934e-02, 1.6490559742319441e-01)),
                (1.0525535644238974e-02, _s111(6.0505783675033412e-02, 2.5976041170346387e-01)),
                (1.3760331394147538e-02, _s111(1.2548211909622189e-01, 2.4143815534801266e-01)),
                (1.3860745244640128e-02, _s111(9.5367159491400733e-02, 3.4863741954287258e-01)),
                (1.7042808935729976e-02, _s111(1.7465941156686071e-01, 3.1605002763020679e-01)),
                ]
        elif index == 8:
            self.degree = 25
            data = [
                (-2.6954961223661029e+00, _s21(2.4170556499722642e-01)),
                (-1.8053087282731432e-03, _s21(6.6841145410301242e-02)),
                (8.1866000177608712e-04, _s21(7.9121374020986561e-03)),
                (3.8724080224669857e-03, _s21(3.8682500223883039e-02)),
                (5.1956272890942620e-03, _s21(4.9571742583009781e-01)),
                (8.2758256036296277e-03, _s21(9.6693451684011195e-02)),
                (1.1494692925102619e-02, _s21(4.7679605292318106e-01)),
                (1.4289758700353008e-02, _s21(1.5136311625338722e-01)),
                (1.5595032733898223e-02, _s21(4.4455143684310217e-01)),
                (1.7062959875833842e-02, _s21(3.6191150147640905e-01)),
                (1.7127072397518896e-02, _s21(4.0188565220838512e-01)),
                (1.4306861745315699e-01, _s21(2.2915717002669783e-01)),
                (1.1371418149652463e-03, _s111(3.0330247109068250e-04, 1.7873092973242388e-01)),
                (1.7135519419954578e-03, _s111(7.2850660720176442e-03, 4.1091962617909122e-02)),
                (1.9681537577992698e-03, _s111(2.0981905527894520e-03, 3.8040500244755365e-01)),
                (2.8980619808650623e-03, _s111(8.2493554021632991e-03, 9.8451598163584092e-02)),
                (4.7760727126949622e-03, _s111(9.1984489688911476e-03, 2.7127899306756620e-01)),
                (6.4898979745711379e-03, _s111(2.2789435125158540e-02, 1.7304270963987173e-01)),
                (6.8410434776279448e-03, _s111(4.3868460650469308e-02, 9.1754132899196483e-02)),
                (8.2647322808636348e-03, _s111(2.4839829916622230e-02, 3.7681165170843428e-01)),
                (1.0224364896269249e-02, _s111(4.6355430068864403e-02, 2.6556158456309281e-01)),
                (1.0244154062961084e-02, _s111(7.1944171977122509e-02, 1.7053912142173719e-01)),
                (1.3671900203659292e-02, _s111(7.7170587472222635e-02, 3.5512733589984241e-01)),
                (1.5057862935694812e-02, _s111(1.1403766860632927e-01, 2.4467281676911143e-01)),
                (1.5806425931878948e-02, _s111(1.5315670236426460e-01, 3.2818945118898774e-01)),
                (1.2978236907405933e+00, _s111(2.3969111281958894e-01, 2.4504506954450558e-01)),
                ]

        self.bary, self.weights = untangle(data)
        self.points = self.bary[:, 1:]
        return
