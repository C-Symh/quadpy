# -*- coding: utf-8 -*-
#
import numpy


class HaegemansPiessens(object):
    """
    Ann Haegemans and Robert Piessens,
    Construction of Cubature Formulas of Degree Seven and Nine Symmetric Planar Regions
    Using Orthogonal Polynomials,
    SIAM Journal on Numerical Analysis, Vol. 14, No. 3 (Jun., 1977), pp. 492-508,
    <http://www.jstor.org/stable/2156699>.

    Abstract:
    A method of constructing twelve-point cubature formulas with polynomial precision
    seven and nineteen-point and eighteen-point cubature formulas with polynomial
    precision nine is given for planar regions and weight functions, which are symmetric
    in each variable. The nodes are computed as common zeros of a set of linearly
    independent orthogonal polynomials.
    """

    def __init__(self, variant):
        self.name = "HaegemansPiessens({})".format(variant)

        if variant == "a":
            self.degree = 7

            self.points = numpy.array(
                [
                    [+0.45825756949558400066e1, +0.45825756949558400066e1],
                    [+0.45825756949558400066e1, -0.45825756949558400066e1],
                    [-0.45825756949558400066e1, +0.45825756949558400066e1],
                    [-0.45825756949558400066e1, -0.45825756949558400066e1],
                    [+0.70236144020646152963e1, 0.0],
                    [-0.70236144020646152963e1, 0.0],
                    [+0.16302145109770590301e1, 0.0],
                    [-0.16302145109770590301e1, 0.0],
                    [0.0, +0.88693729743104806995e1],
                    [0.0, -0.88693729743104806995e1],
                    [0.0, +0.27097193301071890633e1],
                    [0.0, -0.27097193301071890633e1],
                ]
            )

            self.weights = numpy.array(
                [
                    0.53428446489622333987e-1,
                    0.53428446489622333987e-1,
                    0.53428446489622333987e-1,
                    0.53428446489622333987e-1,
                    0.32645130906584894203e-1,
                    0.32645130906584894203e-1,
                    0.20960123475066223175e1,
                    0.20960123475066223175e1,
                    0.74005652121778807454e-2,
                    0.74005652121778807454e-2,
                    0.89867771698516347806,
                    0.89867771698516347806,
                ]
            )
        else:
            assert variant == "b"
            self.degree = 9

            self.points = numpy.array(
                [
                    [+0.31445132948861316205e1, +0.17968204012034815825e1],
                    [+0.31445132948861316205e1, -0.17968204012034815825e1],
                    [-0.31445132948861316205e1, +0.17968204012034815825e1],
                    [-0.31445132948861316205e1, -0.17968204012034815825e1],
                    [+0.81288621554158904245e1, +0.56975989672929856102e1],
                    [+0.81288621554158904245e1, -0.56975989672929856102e1],
                    [-0.81288621554158904245e1, +0.56975989672929856102e1],
                    [-0.81288621554158904245e1, -0.56975989672929856102e1],
                    [+0.31047512376040704732e1, +0.75872948955819104799e1],
                    [+0.31047512376040704732e1, -0.75872948955819104799e1],
                    [-0.31047512376040704732e1, +0.75872948955819104799e1],
                    [-0.31047512376040704732e1, -0.75872948955819104799e1],
                    [+0.88003944155658680273e1, 0.0],
                    [-0.88003944155658680273e1, 0.0],
                    [0.0, +0.34241487633426925811e1],
                    [0.0, -0.34241487633426925811e1],
                    [0.0, +0.14237038816700630838e2],
                    [0.0, -0.14237038816700630838e2],
                    [0.0, 0.0],
                ]
            )

            self.weights = numpy.array(
                [
                    0.42891635372364421816,
                    0.42891635372364421816,
                    0.42891635372364421816,
                    0.42891635372364421816,
                    0.21828892485177877829e-2,
                    0.21828892485177877829e-2,
                    0.21828892485177877829e-2,
                    0.21828892485177877829e-2,
                    0.93469649142381572351e-2,
                    0.93469649142381572351e-2,
                    0.93469649142381572351e-2,
                    0.93469649142381572351e-2,
                    0.61187144873852822063e-2,
                    0.61187144873852822063e-2,
                    0.46279666238296101906,
                    0.46279666238296101906,
                    0.54938772079738427117e-4,
                    0.54938772079738427117e-4,
                    0.35834598443491337448e1,
                ]
            )
        return
